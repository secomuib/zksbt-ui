const snarkjs = require("snarkjs");

const genProof = async (input: any) => {
  const { proof, publicSignals } = await snarkjs.groth16.fullProve(
    input,
    "creditScoreConstraint.wasm",
    "creditScoreConstraint_0001.zkey"
  );

  return { proof, publicSignals };
};

const verifyProof = async (publicSignals: any, proof: any) => {
  const res = await snarkjs.groth16.verify(
    verificationKey,
    publicSignals,
    proof
  );

  return res;
};

const verificationKey = {
  "protocol": "groth16",
  "curve": "bn128",
  "nPublic": 5,
  "vk_alpha_1": [
   "6141975122258765286741695731516650065426828576695676606740720839942634949934",
   "4036859889989342367500943691972682790720060801844101912306995885223296631744",
   "1"
  ],
  "vk_beta_2": [
   [
    "19828744323862407500967416720182636030005542571914154878962365514430214423052",
    "3852551203131731096246548893453816968550147741938212161322487541964010568015"
   ],
   [
    "12763340354406346989949852816253425129716692338869829647959526906056414274969",
    "11684568823912070129665345253497291373205502582163544021473758978847948299841"
   ],
   [
    "1",
    "0"
   ]
  ],
  "vk_gamma_2": [
   [
    "10857046999023057135944570762232829481370756359578518086990519993285655852781",
    "11559732032986387107991004021392285783925812861821192530917403151452391805634"
   ],
   [
    "8495653923123431417604973247489272438418190587263600148770280649306958101930",
    "4082367875863433681332203403145435568316851327593401208105741076214120093531"
   ],
   [
    "1",
    "0"
   ]
  ],
  "vk_delta_2": [
   [
    "7827485888333245586463491166173187426927688279208992695691988265312159859169",
    "18473500901297399207569058199905452076124460994372917930531255494185682331047"
   ],
   [
    "1918003336255808900327245426824056156873483984239263356498411715347411532238",
    "4078539391700157369261283436820965474842309114228603997335605753820913317977"
   ],
   [
    "1",
    "0"
   ]
  ],
  "vk_alphabeta_12": [
   [
    [
     "11896285839806265670496801077190739997567906837914499740126926608631117276631",
     "2264542598187863059526183934688627849627955788011057304240079942549328424446"
    ],
    [
     "12057611011200562891635578183410338481820904763706737790772090586921227726930",
     "3284993179072647318908343232435542005922634552169842563644751505003034496674"
    ],
    [
     "14248374177460569305183072478314895087765147201738866538347941867597835849892",
     "15521146276779280780435903249849372375446059898798840678073647765973680408417"
    ]
   ],
   [
    [
     "17616166868483352890019835215340958416124260554726643188969971373798120608508",
     "13914179825572222959677797928363348035050312543976249323526181526280877954420"
    ],
    [
     "21556573686514856206071632708325783898889691349788129514415333407580860183113",
     "10461371404391138248041599190756782232381599768740374296394524917682968581189"
    ],
    [
     "6534251836758737868302868593229700160902572059549801080829996624524877900196",
     "12426535592206081755496809602713477899721893517437434089272002340704669262681"
    ]
   ]
  ],
  "IC": [
   [
    "2167148597516293519782036701642010200118798789383612615005132375909482465115",
    "13987142744957109780307397567725140205212822910758534538103864144187779060262",
    "1"
   ],
   [
    "9978022000965948819937584666723861046729170013980734975470171967983241807295",
    "11201703715946450856049270874485818438729534714136605854851733154341601378573",
    "1"
   ],
   [
    "6206253153712381571803239464901991691549062241460139545612466173348271638362",
    "17811557103513911096626490527886313479949477680859497640400645589531755009459",
    "1"
   ],
   [
    "3688527869451826281295364462285032972867839498204058613359260898069043935220",
    "16744454907442065910289154350178054767585883546368436081831528612450033299878",
    "1"
   ],
   [
    "179207449257295433241059315566164231425112715677495254535952622904611649331",
    "7978561463176838267470581989964019133969565450168923236593302465396000121129",
    "1"
   ],
   [
    "12009715456499709272869877048290664190285143885630226429635008607098399585911",
    "6392672622817734846410970403695916168609993305084103002083477461319664802445",
    "1"
   ]
  ]
 };

export {
  genProof,
  verifyProof  
};
