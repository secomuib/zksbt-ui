const snarkjs = require("snarkjs");

const genProof = async (input: any) => {
  const { proof, publicSignals } = await snarkjs.groth16.fullProve(
    input,
    "creditScoreConstraint.wasm",
    "creditScoreConstraint_0001.zkey"
  );

  return { proof, publicSignals };
};

const verifyProof = async (publicSignals: any, proof: any) => {
  const res = await snarkjs.groth16.verify(
    verificationKey,
    publicSignals,
    proof
  );

  return res;
};

const verificationKey = {
  "protocol": "groth16",
  "curve": "bn128",
  "nPublic": 4,
  "vk_alpha_1": [
   "2630342882842877684212825729256736311777728570949814527543022414348544661466",
   "8377866405934786651135890476946108972777413112467574175137185500259622777626",
   "1"
  ],
  "vk_beta_2": [
   [
    "6613499249035265638643944557042126005206130821187577649564344133778875159809",
    "7834838714067052992437381216586573567831980322476648113393913460372191455730"
   ],
   [
    "14069422852782178082296743167230581749612730606843840984754799153098974716939",
    "14654731365103293203178811468191345526823963057000212774902371232024568358271"
   ],
   [
    "1",
    "0"
   ]
  ],
  "vk_gamma_2": [
   [
    "10857046999023057135944570762232829481370756359578518086990519993285655852781",
    "11559732032986387107991004021392285783925812861821192530917403151452391805634"
   ],
   [
    "8495653923123431417604973247489272438418190587263600148770280649306958101930",
    "4082367875863433681332203403145435568316851327593401208105741076214120093531"
   ],
   [
    "1",
    "0"
   ]
  ],
  "vk_delta_2": [
   [
    "9899903958362461564602607853907901322892477939931495658723705871854164316090",
    "5397879831884329048567759276694684891527121177734952601492950998483613641180"
   ],
   [
    "4499940881082226161357790118170747909628954225814507596578279644862137576657",
    "19820660211748046452469597816722798570021678568677207914433657123752930257072"
   ],
   [
    "1",
    "0"
   ]
  ],
  "vk_alphabeta_12": [
   [
    [
     "2812487613176903653247307903057532272302313299147875444067216439724784805024",
     "15940246902725382049475081106949091258909851474353771954331034641732565774193"
    ],
    [
     "13457042890142096001718177473883496251309653819035117916085125504888649815706",
     "9483985007154956645133550754681303991529911210575879492735424119581036154616"
    ],
    [
     "3019303711158858802925927163919482470785613765731554564523402842278267890980",
     "6669384778297837768620341272786662551899792537387526292663421175025524728349"
    ]
   ],
   [
    [
     "11144733770623902339730441328098589514696258171604554378507214808791894882035",
     "16353372769407827890062526740469923099250277668586087242904838697474324880004"
    ],
    [
     "6167427436956040969721214563983796516051156434794936004534957760340491411108",
     "21194598641422607476796611905146208561963608434703054856147096923265445039605"
    ],
    [
     "5231643796720988540837810085839705348588077662979347340027632863159914648385",
     "3507653041888535097689700214941912310327207506885143985467759336012681955799"
    ]
   ]
  ],
  "IC": [
   [
    "12146199154662929040590086590212915643988177518680691328858597542439185208294",
    "18824921550964663108657050750506352927673626740633223194898354352557934930431",
    "1"
   ],
   [
    "4813986716268121476797445730152270445595405680324781894908794177191774637915",
    "16944289286893112772761038720454662265860229805462187411577148472387611303168",
    "1"
   ],
   [
    "14084015192984310626005305665202254313595589228181779815537661325028119711753",
    "14415146095223953971264842260905096067843794310109165858529670136815333173303",
    "1"
   ],
   [
    "4373618996929805506712305927249136882032151234209043542582489650749052585142",
    "11253556006021585549827461228292447317589125086614247505319353491610939240854",
    "1"
   ],
   [
    "6157493719643063347758319963121200167721758310988828365965784926604620663133",
    "9424149158297062697528287394959034060466544290365471936427831319618257160893",
    "1"
   ]
  ]
 };

export {
  genProof,
  verifyProof  
};
